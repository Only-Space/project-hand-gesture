<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gesture Launcher - Dual Camera</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&family=Orbitron:wght@700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-glow: #00ffff;
            --secondary-glow: #0dff00;
            --red-glow: #ff4444;
            --background-start: #0c111e;
            --background-end: #1a202c;
            --text-color: #e0f2f7;
        }

        body {
            margin: 0;
            background: linear-gradient(135deg, var(--background-end) 0%, var(--background-start) 100%);
            color: var(--text-color);
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 50px;
            min-height: 100vh;
        }

        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .input_video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scaleX(-1);
            width: 100%;
            height: 100%;
            max-width: 460px;
            max-height: 460px;
            object-fit: cover;
            border-radius: 50%;
            opacity: 40%;
            z-index: 0;
            transition: opacity 0.5s ease;
        }

        .scan-container {
            position: relative;
            z-index: 1;
            width: 45vmin;
            height: 45vmin;
            max-width: 500px;
            max-height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid rgba(0, 255, 255, 0.2);
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.2);
            animation: strobe-animation 1.5s ease-in-out infinite;
            transition: opacity 0.5s ease, transform 0.5s ease;
            overflow: hidden;
        }

        .scan-container.access-granted {
            animation-name: strobe-animation-green;
            border-color: rgba(13, 255, 0, 0.2);
        }

        .futuristic-arm-overlay {
            position: absolute;
            width: 70%;
            height: 70%;
            object-fit: cover;
            opacity: 30%;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
            z-index: 2;
        }

        .scan-container.identifying .futuristic-arm-overlay {
            opacity: 0;
        }

        @keyframes strobe-animation {
            0%, 100% {
                box-shadow: 0 0 35px rgba(0, 255, 255, 0.3);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 70px 10px rgba(0, 255, 255, 0.75);
                transform: scale(1.015);
            }
        }

        @keyframes strobe-animation-green {
            0%, 100% {
                box-shadow: 0 0 35px var(--secondary-glow);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 70px 10px var(--secondary-glow);
                transform: scale(1.015);
            }
        }

        @keyframes strobe-animation-red {
            0%, 100% {
                box-shadow: 0 0 35px var(--red-glow);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 70px 10px var(--red-glow);
                transform: scale(1.015);
            }
        }

        /* Styling khusus untuk container 2 */
        #container2 {
            border-color: rgba(255, 68, 68, 0.2);
        }

        #container2.red-theme {
            animation-name: strobe-animation-red;
        }

        #container2 .instructions {
            color: var(--red-glow);
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.7),
                0 0 20px rgba(255, 68, 68, 0.5),
                0 0 30px rgba(255, 68, 68, 0.3);
        }

        #progress-bar2 {
            stroke: var(--red-glow);
        }

        .progress-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
            z-index: 3;
        }

        .progress-circle circle {
            fill: none;
            stroke-width: 6px;
        }

        .progress-bg {
            stroke: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            stroke: var(--primary-glow);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.2s linear;
        }

        .ui-text-wrapper {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4;
        }

        .ui-text {
            opacity: 0;
            visibility: hidden;
            position: absolute;
            text-align: center;
            transition: opacity 0.4s ease-in-out, visibility 0s linear 0.4s;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* Default text shadow untuk container 1 */
        #container1 .ui-text {
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.7),
                0 0 20px rgba(0, 255, 255, 0.5),
                0 0 30px rgba(0, 255, 255, 0.3);
        }

        /* Text shadow merah untuk container 2 */
        #container2 .ui-text {
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.7),
                0 0 20px rgba(255, 68, 68, 0.5),
                0 0 30px rgba(255, 68, 68, 0.3) !important;
        }

        #container2 #instructions2,
        #container2 #status-message2,
        #container2 #countdown-display2,
        #container2 #launch-message2 {
            text-shadow: 0 0 10px rgba(255, 68, 68, 0.7),
                0 0 20px rgba(255, 68, 68, 0.5),
                0 0 30px rgba(255, 68, 68, 0.3) !important;
        }

        .visible {
            opacity: 1 !important;
            visibility: visible !important;
            transition: opacity 0.4s ease-in-out;
        }

        .instructions {
            font-size: 0.75em;
            color: var(--primary-glow);
            animation: pulseText 1.5s infinite;
        }

        .status-message {
            font-size: 0.7em;
            color: #ffffff;
        }

        .countdown-display {
            font-size: 6em;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.7);
        }

        .launch-message .label {
            font-size: 1.2em;
            font-weight: 300;
            color: var(--primary-glow);
            text-shadow: 0 0 10px var(--primary-glow);
        }

        .launch-message .loading-percent {
            font-size: 3em;
            font-weight: 700;
            margin-top: 10px;
        }

        .launch-message .final-message {
            font-size: 2em;
            font-weight: 700;
        }

        @keyframes pulseText {
            0%, 100% {
                text-shadow: 0 0 10px rgba(0, 255, 255, 0.7),
                    0 0 20px rgba(0, 255, 255, 0.5),
                    0 0 30px rgba(0, 255, 255, 0.3);
                transform: scale(1);
            }
            50% {
                text-shadow: 0 0 15px rgba(0, 255, 255, 1),
                    0 0 30px rgba(0, 255, 255, 0.8),
                    0 0 45px rgba(0, 255, 255, 0.5);
                transform: scale(1.05);
            }
        }

        #start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(12, 17, 30, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
            color: var(--text-color);
        }

        #start-overlay h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            text-shadow: 0 0 15px var(--primary-glow);
            margin-bottom: 10px;
        }

        #start-overlay p {
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        #start-button {
            background-color: var(--primary-glow);
            color: var(--background-start);
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            border-radius: 5px;
            text-transform: uppercase;
            box-shadow: 0 0 20px var(--primary-glow);
            transition: all 0.3s ease;
        }

        #start-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--primary-glow);
        }
    </style>
</head>

<body>
    <canvas id="particle-canvas"></canvas>

    <!-- Container 1 -->
    <div class="scan-container" id="container1">
        <video class="input_video" id="input_video1" autoplay playsinline></video>
        <img src="futuristic-arm-removebg-preview.png" class="futuristic-arm-overlay" alt="Futuristic Arm Scan">

        <svg class="progress-circle" viewBox="0 0 100 100">
            <circle class="progress-bg" cx="50" cy="50" r="45"></circle>
            <circle class="progress-bar" id="progress-bar1" cx="50" cy="50" r="45"></circle>
        </svg>

        <div class="ui-text-wrapper">
            <p id="instructions1" class="ui-text instructions visible">Letakkan tangan<br>di depan kamera 1</p>
            <p id="status-message1" class="ui-text status-message"></p>
            <p id="countdown-display1" class="ui-text countdown-display"></p>
            <p id="launch-message1" class="ui-text launch-message"></p>
        </div>
    </div>

    <!-- Container 2 -->
    <div class="scan-container" id="container2">
        <video class="input_video" id="input_video2" autoplay playsinline></video>
        <img src="futuristic-arm-removebg-preview.png" class="futuristic-arm-overlay" alt="Futuristic Arm Scan">

        <svg class="progress-circle" viewBox="0 0 100 100">
            <circle class="progress-bg" cx="50" cy="50" r="45"></circle>
            <circle class="progress-bar" id="progress-bar2" cx="50" cy="50" r="45"></circle>
        </svg>

        <div class="ui-text-wrapper">
            <p id="instructions2" class="ui-text instructions visible">Letakkan tangan<br>di depan kamera 2</p>
            <p id="status-message2" class="ui-text status-message"></p>
            <p id="countdown-display2" class="ui-text countdown-display"></p>
            <p id="launch-message2" class="ui-text launch-message"></p>
        </div>
    </div>

    <audio id="beep-sound" src="beep.mp3" preload="auto"></audio>
    <audio id="intro-sound" src="intro-rise.mp3" preload="auto"></audio>

    <div id="start-overlay">
        <h1>Gesture Launcher - Dual Camera</h1>
        <p>Klik untuk mengaktifkan 2 kamera dan memulai</p>
        <button id="start-button">MULAI</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>

    <script>
        const startOverlay = document.getElementById('start-overlay');
        const startButton = document.getElementById('start-button');
        const beepAudio = document.getElementById('beep-sound');
        const introAudio = document.getElementById('intro-sound');

        // Status global untuk validasi kedua tangan
        let globalHandDetectionStatus = {
            camera1HandDetected: false,
            camera2HandDetected: false,
            bothHandsValidated: false
        };

        // Konfigurasi untuk kedua container
        const configs = [
            {
                id: 1,
                videoElement: document.getElementById("input_video1"),
                instructionsElement: document.getElementById("instructions1"),
                statusMessageElement: document.getElementById("status-message1"),
                countdownDisplayElement: document.getElementById("countdown-display1"),
                launchMessageElement: document.getElementById("launch-message1"),
                scanContainer: document.getElementById("container1"),
                progressBar: document.getElementById('progress-bar1'),
                openHandCounter: 0,
                thresholdFrames: 100,
                gestureTriggered: false,
                countdownInterval: null,
                hands: null,
                camera: null,
                handDetected: false
            },
            {
                id: 2,
                videoElement: document.getElementById("input_video2"),
                instructionsElement: document.getElementById("instructions2"),
                statusMessageElement: document.getElementById("status-message2"),
                countdownDisplayElement: document.getElementById("countdown-display2"),
                launchMessageElement: document.getElementById("launch-message2"),
                scanContainer: document.getElementById("container2"),
                progressBar: document.getElementById('progress-bar2'),
                openHandCounter: 0,
                thresholdFrames: 100,
                gestureTriggered: false,
                countdownInterval: null,
                hands: null,
                camera: null,
                handDetected: false
            }
        ];

        // Setup progress bar untuk setiap container
        configs.forEach(config => {
            const radius = config.progressBar.r.baseVal.value;
            const circumference = 2 * Math.PI * radius;
            config.progressBar.style.strokeDasharray = circumference;
            config.circumference = circumference;
        });

        function showElement(config, el, message = null) {
            config.scanContainer.querySelectorAll('.ui-text').forEach(p => p.classList.remove('visible'));
            if (message) el.innerHTML = message;
            el.classList.add('visible');
        }

        function setProgress(config, percent, color = null) {
            const offset = config.circumference - (percent / 100) * config.circumference;
            config.progressBar.style.strokeDashoffset = offset;
            if (color) {
                config.progressBar.style.stroke = color;
            } else {
                // Set warna default berdasarkan container
                if (config.id === 2) {
                    config.progressBar.style.stroke = 'var(--red-glow)';
                } else {
                    config.progressBar.style.stroke = 'var(--primary-glow)';
                }
            }
        }

        function startCountdown(config) {
            if (config.gestureTriggered) return;
            config.gestureTriggered = true;
            let countdownValue = 3;
            showElement(config, config.countdownDisplayElement, countdownValue);

            beepAudio.currentTime = 0;
            beepAudio.play();

            config.countdownInterval = setInterval(() => {
                countdownValue--;
                if (countdownValue > 0) {
                    beepAudio.currentTime = 0;
                    beepAudio.play();
                }
                config.countdownDisplayElement.innerHTML = countdownValue;

                if (countdownValue <= 0) {
                    clearInterval(config.countdownInterval);
                    launchProduct(config);
                }
            }, 1000);
        }

        async function launchProduct(config) {
            if (config.camera) config.camera.stop();
            config.videoElement.style.opacity = '0';
            config.scanContainer.classList.add('identifying');
            showElement(config, config.launchMessageElement);

            introAudio.currentTime = 0;
            introAudio.play();

            function animateLoading(percentage) {
                config.launchMessageElement.innerHTML =
                    `<div class="label">IDENTIFYING</div><div class="loading-percent">${percentage}%</div>`;
                setProgress(config, percentage, 'var(--primary-glow)');

                let delay = (percentage >= 98) ? 800 : 55;

                if (percentage < 100) {
                    setTimeout(() => animateLoading(percentage + 1), delay);
                } else {
                    setTimeout(() => {
                        config.scanContainer.classList.add('access-granted');
                        config.launchMessageElement.innerHTML =
                            `<div class="final-message" style="color: var(--secondary-glow); text-shadow: 0 0 10px var(--secondary-glow);">ACCESS GRANTED</div>`;
                        let greenPercent = 0;

                        function fillGreenBar() {
                            setProgress(config, greenPercent, 'var(--secondary-glow)');
                            if (greenPercent < 100) {
                                greenPercent++;
                                setTimeout(fillGreenBar, 10);
                            } else {
                                setTimeout(() => {
                                    window.location.href = "https://www.youtube.com/";
                                }, 1000);
                            }
                        }
                        fillGreenBar();
                    }, 500);
                }
            }
            animateLoading(0);
        }

        function createOnResults(config) {
            return function(results) {
                if (config.gestureTriggered) return;

                const handDetected = results.multiHandLandmarks && results.multiHandLandmarks.length > 0;
                config.handDetected = handDetected;

                // Update status global
                if (config.id === 1) {
                    globalHandDetectionStatus.camera1HandDetected = handDetected;
                } else if (config.id === 2) {
                    globalHandDetectionStatus.camera2HandDetected = handDetected;
                }

                // Cek apakah kedua tangan terdeteksi
                const bothHandsDetected = globalHandDetectionStatus.camera1HandDetected && 
                                         globalHandDetectionStatus.camera2HandDetected;

                if (handDetected) {
                    // Jika tangan terdeteksi tapi tangan lain belum
                    if (!bothHandsDetected) {
                        const otherCameraId = config.id === 1 ? 2 : 1;
                        const otherConfig = configs[otherCameraId - 1];
                        
                        // Cek apakah kamera lain tidak tersedia
                        if (!otherConfig.camera) {
                            showElement(config, config.statusMessageElement, 
                                `⚠️ PROGRAM TIDAK<br>DAPAT BERJALAN<br><br><span style="font-size: 0.85em;">Kamera ${otherCameraId} tidak tersedia<br>Kedua tangan<br>harus terdeteksi</span>`);
                            config.statusMessageElement.style.color = '#ff4444';
                            config.statusMessageElement.style.fontSize = '0.75em';
                            config.scanContainer.style.borderColor = 'rgba(255, 68, 68, 0.5)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(255, 68, 68, 0.5)';
                            return;
                        } else {
                            showElement(config, config.statusMessageElement, 
                                `⚠️ Menunggu tangan<br>di kamera ${otherCameraId}...<br><br><span style="font-size: 0.85em;">Kedua tangan<br>harus terdeteksi</span>`);
                            config.statusMessageElement.style.color = '#ffa500';
                            config.statusMessageElement.style.fontSize = '0.7em';
                            config.scanContainer.style.borderColor = 'rgba(255, 165, 0, 0.4)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(255, 165, 0, 0.4)';
                            return;
                        }
                    }

                    // Kedua tangan terdeteksi, lanjutkan deteksi gesture
                    const landmarks = results.multiHandLandmarks[0];
                    const isHandOpen = [8, 12, 16, 20].every(i => landmarks[i].y < landmarks[i - 2].y);

                    if (isHandOpen) {
                        config.openHandCounter++;
                        const validationPercent = Math.round((config.openHandCounter / config.thresholdFrames) * 100);
                        showElement(config, config.statusMessageElement, `Validasi... ${validationPercent}%`);
                        config.statusMessageElement.style.fontSize = '0.7em';
                        
                        if (config.id === 2) {
                            config.statusMessageElement.style.color = '#ff4444';
                            config.scanContainer.style.borderColor = 'rgba(255, 68, 68, 0.3)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(255, 68, 68, 0.4)';
                        } else {
                            config.statusMessageElement.style.color = '#ffffff';
                            config.scanContainer.style.borderColor = 'rgba(0, 255, 255, 0.2)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(0, 255, 255, 0.3)';
                        }
                        
                        if (config.openHandCounter >= config.thresholdFrames) {
                            startCountdown(config);
                        }
                    } else {
                        config.openHandCounter = 0;
                        showElement(config, config.statusMessageElement, "Buka telapak tangan<br>untuk memulai.");
                        config.statusMessageElement.style.fontSize = '0.7em';
                        
                        if (config.id === 2) {
                            config.statusMessageElement.style.color = '#ff4444';
                            config.scanContainer.style.borderColor = 'rgba(255, 68, 68, 0.2)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(255, 68, 68, 0.3)';
                        } else {
                            config.statusMessageElement.style.color = '#ffffff';
                            config.scanContainer.style.borderColor = 'rgba(0, 255, 255, 0.2)';
                            config.scanContainer.style.boxShadow = '0 0 35px rgba(0, 255, 255, 0.3)';
                        }
                    }
                } else {
                    config.openHandCounter = 0;
                    showElement(config, config.instructionsElement);
                    
                    if (config.id === 2) {
                        config.scanContainer.style.borderColor = 'rgba(255, 68, 68, 0.2)';
                        config.scanContainer.style.boxShadow = '0 0 35px rgba(255, 68, 68, 0.3)';
                    } else {
                        config.scanContainer.style.borderColor = 'rgba(0, 255, 255, 0.2)';
                        config.scanContainer.style.boxShadow = '0 0 35px rgba(0, 255, 255, 0.3)';
                    }
                }
            };
        }

        async function initializeApp() {
            startOverlay.style.display = 'none';

            beepAudio.play().then(() => beepAudio.pause()).catch(e => console.log("Audio context needs user interaction."));
            introAudio.play().then(() => introAudio.pause()).catch(e => {});

            // Tambahkan class red-theme ke container 2
            configs[1].scanContainer.classList.add('red-theme');

            // Dapatkan semua kamera yang tersedia
            const devices = await navigator.mediaDevices.enumerateDevices();
            const videoDevices = devices.filter(device => device.kind === 'videoinput');

            // Cek apakah kamera kurang dari 2
            if (videoDevices.length < 2) {
                const config2 = configs[1];
                config2.videoElement.style.opacity = '0';
                showElement(config2, config2.instructionsElement, 
                    `⚠️ KAMERA KEDUA<br>TIDAK TERDETEKSI<br><br><span style="font-size: 0.8em;">Hanya ${videoDevices.length} kamera<br>tersedia</span>`);
                config2.instructionsElement.style.color = '#ff4444';
                config2.instructionsElement.style.fontSize = '0.9em';
                config2.scanContainer.style.borderColor = 'rgba(255, 68, 68, 0.5)';
                config2.scanContainer.style.boxShadow = '0 0 35px rgba(255, 68, 68, 0.5)';
                config2.scanContainer.style.animation = 'none';
            }

            // Inisialisasi setiap container dengan kamera berbeda
            for (let i = 0; i < configs.length && i < videoDevices.length; i++) {
                const config = configs[i];
                const deviceId = videoDevices[i].deviceId;

                // Inisialisasi MediaPipe Hands
                config.hands = new Hands({
                    locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
                });
                config.hands.setOptions({
                    maxNumHands: 1,
                    modelComplexity: 1,
                    minDetectionConfidence: 0.7,
                    minTrackingConfidence: 0.7,
                });
                config.hands.onResults(createOnResults(config));

                // Inisialisasi kamera dengan device ID spesifik
                config.camera = new Camera(config.videoElement, {
                    onFrame: async () => {
                        if (config.videoElement.readyState >= 2) {
                            await config.hands.send({
                                image: config.videoElement
                            });
                        }
                    },
                    width: 640,
                    height: 480,
                    deviceId: deviceId
                });

                config.camera.start().catch(err => {
                    console.error(`Camera ${config.id} start failed:`, err);
                    showElement(config, config.instructionsElement, "Error: Tidak dapat mengakses kamera.");
                });

                setProgress(config, 0);
            }
        }

        startButton.addEventListener('click', initializeApp);
    </script>

    <script>
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let particlesArray;
        const scanContainers = document.querySelectorAll('.scan-container');

        class Particle {
            constructor(x, y, directionX, directionY, size, color) {
                this.x = x;
                this.y = y;
                this.directionX = directionX;
                this.directionY = directionY;
                this.size = size;
                this.color = color;
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                ctx.fillStyle = 'rgba(0, 255, 255, 0.5)';
                ctx.fill();
            }
            update() {
                if (this.x > canvas.width || this.x < 0) this.directionX *= -1;
                if (this.y > canvas.height || this.y < 0) this.directionY *= -1;

                let nextX = this.x + this.directionX;
                let nextY = this.y + this.directionY;

                // Check collision dengan semua container
                scanContainers.forEach(container => {
                    const rect = container.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    const radius = Math.max(rect.width, rect.height) / 2;

                    const distNext = Math.sqrt((nextX - centerX) ** 2 + (nextY - centerY) ** 2);

                    if (distNext < radius + this.size) {
                        this.directionX *= -1;
                        this.directionY *= -1;
                        nextX = this.x + this.directionX;
                        nextY = this.y + this.directionY;
                    }
                });

                this.x = nextX;
                this.y = nextY;
                this.draw();
            }
        }

        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 25000;

            for (let i = 0; i < numberOfParticles; i++) {
                let size = (Math.random() * 2) + 1;
                let x, y, validPosition;

                do {
                    x = Math.random() * innerWidth;
                    y = Math.random() * innerHeight;
                    validPosition = true;

                    // Check apakah posisi berada di luar semua container
                    scanContainers.forEach(container => {
                        const rect = container.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const centerY = rect.top + rect.height / 2;
                        const radius = Math.max(rect.width, rect.height) / 2;
                        const dist = Math.sqrt((x - centerX) ** 2 + (y - centerY) ** 2);
                        
                        if (dist < radius + size) {
                            validPosition = false;
                        }
                    });
                } while (!validPosition);

                let dirX = (Math.random() * .3) - .15;
                let dirY = (Math.random() * .3) - .15;
                particlesArray.push(new Particle(x, y, dirX, dirY, size, 'rgba(0, 255, 255, 0.8)'));
            }
        }

        function connect() {
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) ** 2) +
                        ((particlesArray[a].y - particlesArray[b].y) ** 2);
                    if (distance < 20000) {
                        let opacityValue = 1 - (distance / 20000);
                        ctx.strokeStyle = `rgba(0, 255, 255, ${opacityValue})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                        ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                        ctx.stroke();
                    }
                }
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            ctx.clearRect(0, 0, innerWidth, innerHeight);

            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
            }
            connect();
        }

        window.addEventListener('resize', () => {
            canvas.width = innerWidth;
            canvas.height = innerHeight;
            init();
        });

        init();
        animate();
    </script>
</body>

</html>